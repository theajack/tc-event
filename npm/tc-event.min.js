!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.TEvent=n():e.TEvent=n()}(this,(function(){return function(e){var n={};function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(r,i,function(n){return e[n]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){"use strict";function r(e){return void 0===e}function i(e,n,t){var r=e.length;return 0===r?0:function e(n,t,r,i,o){var u=Math.floor((t+r)/2);if(t>r)return u+1;return n[u].index>i?e(n,t,u-1,i,o):n[u].index<i?e(n,u+1,r,i,o):o?0===u||n[u-1].index<i?u:e(n,t,u-1,i,o):u===n.length-1||n[u+1].index>i?u+1:e(n,u+1,r,i,o)}(e,0,r-1,n,t)}function o(){var e=[],n=!1;return{add:function(t){var r=t.index,i=t.func;n?e.push({index:r,func:i}):i()},lock:function(t){n=!0;var r=t();return function(){if(0!==e.length){e.sort((function(e,n){return n.index-e.index}));for(var n=e.length-1;n>=0;n--)e[n].func();e=[]}}(),n=!1,r}}}var u;t.r(n);var s;var f=function(e,n){s&&s(e,n)};var c=function(){function e(e){this.name=e,this._init()}return e.prototype._init=function(){this._locker=o(),this._triggerData=void 0,this.hasTrigger=!1,this.id=0,this.index=0,this.listeners=[]},e.prototype._getListenerNumber=function(){return this.listeners.length},e.prototype.reset=function(){this.listeners=[]},e.prototype.regist=function(e){var n=this,t=e.listener,r=e.once,o=void 0!==r&&r,s=e.all,f=void 0===s||s,c=e.index,a=e.indexBefore,l=void 0!==a&&a;"number"!=typeof c&&(c=++this.index);var d,v,h=this.listeners.length,p={name:this.name,listener:t,once:o,all:f,hasTrigger:!1,index:c,id:++this.id};d=this.name,v=p,u&&u(d,v);var g=0===h||c>this._findLastIndex()?h:i(this.listeners,c,l);return this._locker.add({index:g,func:function(){n.listeners.splice(g,0,p)}}),f&&this.hasTrigger&&(o&&(p.hasTrigger=!0),t(this._triggerData,!1)),p},e.prototype._findLastIndex=function(){for(var e=this.listeners.length-1;e>=0;e--)if(this.listeners[e])return this.listeners[e].index;return 0},e.prototype.emit=function(e){var n=this;return this._locker.lock((function(){var t=!1===n.hasTrigger;n.hasTrigger||(n.hasTrigger=!0),n._triggerData=e;for(var r=0;r<n.listeners.length;r++){var i=n.listeners[r];!i||i.once&&i.hasTrigger||(i.hasTrigger=!0,i.listener(e,t),f(n.name,i))}return t}))},e.prototype.remove=function(e,n){var t,r=this;void 0===n&&(n=!1);var i=typeof e;if("number"===i)t="id";else{if("function"!==i)return console.warn("removeEvent 传入的参数有误"),!1;t="listener"}var o=this.listeners.find((function(n){return n&&n[t]===e}));if(!o)return console.warn("removeEvent:未找到监听函数 "+this.name),!1;var u=this.listeners.indexOf(o);return n&&(this.listeners[u]=void 0),this._locker.add({index:u,func:function(){r.listeners.splice(u,1)}}),!0},e.prototype.clear=function(){return this._init(),!0},e}(),a={},l={};function d(e){return a[p(e)]}function v(e){return r(e)?l:l[p(e)]}function h(){a={},l={},u=void 0,s=void 0}function p(e){return"number"==typeof e?e.toString():e}var g=function(){return(g=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function y(e){return!!d(e)}function m(e){r(v(e))&&function(e){var n=p(e);a[n]=new c(n),l[n]=n}(e)}function x(e){var n=e.once,t=void 0!==n&&n,r=e.all,i=void 0===r||r,o=e.name,u=e.listener,s=e.index,f=e.indexBefore;return y(o)||m(o),d(o).regist({listener:u,once:t,all:i,index:s,indexBefore:f})}n.default={version:"0.0.1",EVENT:v(),emit:function(e,n){return y(e)||m(e),d(e).emit(n)},onEmit:function(e){s=e},regist:function e(n,t){if("object"==typeof n){var r={};for(var i in n)r[i]=e(i,n[i]);return r}return"function"==typeof t?x({name:n,listener:t}):"object"==typeof t?x(g({name:n},t)):(console.warn("错误的listener",n,t),null)},onRegist:function(e){u=e},checkEvent:y,remove:function e(n,t,i){if("object"==typeof n)return i=t,null===n?(console.error("参数错误",n),!1):e(n.name,n.id,i);if("object"==typeof n){var o=n;return e(o.name,o.id)}return y(n)?r(t)?(console.error("请传入要移除的listener 或 id"),!1):d(n).remove(t,i):(console.warn("removeEvent:未找到事件 "+n),!1)},clear:function e(n){var t;"string"==typeof n||"number"==typeof n?y(n)&&(d(n).clear(),delete a[p(t=n)],delete l[p(t)]):n instanceof Array?n.forEach((function(n){e(n)})):h()},index:function(e){return y(e)?d(e).index:-1}}}]).default}));